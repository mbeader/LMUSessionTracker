@if(session != null) {
@if(!hasStandings || session.nextSession) {
<div class="alert alert-info alert-dismissible fade show text-center" role="alert">
    @if(session.sessionState?.gamePhase == 8 && session.nextSession) {
    <span>This session is complete and transitioned to <a [routerLink]="['/', 'Session', session.nextSession.sessionId]">{{ session.nextSession.sessionType }}</a></span>
    } @else if(session.nextSession) {
    <span>This session is not live and transitioned to <a [routerLink]="['/', 'Session', session.nextSession.sessionId]">{{ session.nextSession.sessionType }}</a></span>
    } @else {
    <span>This session is not live</span>
    }
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
}
@if(session.session != null && session.sessionState != null) {
<div class="row">
    <div class="col-xxl">
        <h3>Session</h3>
        <dl class="row">
            <dt class="col-xxl-3 col-lg-1 col-3">Track</dt>
            <dd class="col-xxl-9 col-lg-3 col-9 text-truncate" title="{{ session.session.trackName }}">{{ session.session.trackName }}</dd>
            <dt class="col-xxl-3 col-lg-2 col-3">Session</dt>
            <dd class="col-xxl-3 col-lg-2 col-3 text-truncate" title="{{ session.session.sessionType }}">{{ session.session.sessionType }}</dd>
            <dt class="col-xxl-3 col-lg-2 col-3">Phase</dt>
            <dd class="col-xxl-3 col-lg-2 col-3 text-truncate" title="{{ Format.phase(session.sessionState.gamePhase) }}">{{ Format.phase(session.sessionState.gamePhase) }}</dd>
            <dt class="col-xxl-3 col-lg-1 col-3">Players</dt>
            <dd class="col-xxl-3 col-lg-1 col-3">{{ session.sessionState.numberOfPlayers }}</dd>
            <dt class="col-xxl-3 col-lg-2 col-3">Caution</dt>
            <dd class="col-xxl-3 col-lg-2 col-3 text-truncate" title="{{ session.sessionState.yellowFlagState }}">{{ session.sessionState.yellowFlagState }}</dd>
            <dt class="col-xxl-6 col-lg-3 col-3">Sector flags</dt>
            <dd class="col-xxl-6 col-lg-3 col-3"><span [class]="flagClass(session.sessionState.sector1Flag)" title="{{ session.sessionState.sector1Flag }}"></span>&nbsp;<span [class]="flagClass(session.sessionState.sector2Flag, true)" title="{{ session.sessionState.sector2Flag }}"></span>&nbsp;<span [class]="flagClass(session.sessionState.sector3Flag)" title="{{ session.sessionState.sector3Flag }}"></span></dd>
        </dl>
    </div>

    <div class="col-lg">
        <h3>Timing</h3>
        <dl class="row">
            <dt class="col-3">Elapsed</dt>
            <dd class="col-3">{{ Format.time(session.sessionState.currentEventTime) }}</dd>
            <dt class="col-3">Remaining</dt>
            <dd class="col-3">{{ Format.time(session.sessionState.timeRemainingInGamePhase) }}</dd>
            <dt class="col-3">Start time</dt>
            <dd class="col-3">{{ Format.time(session.session.startEventTime) }}</dd>
            <dt class="col-3">End time</dt>
            <dd class="col-3">{{ Format.time(session.session.endEventTime) }}</dd>
            <dt class="col-3">Completion</dt>
            <dd class="col-3">{{ Format.percent(session.sessionState.raceCompletion) }}</dd>
            <dt class="col-3">Max time</dt>
            <dd class="col-3">{{ Format.time(session.session.maxTime) }}</dd>
        </dl>
    </div>

    <div class="col-lg">
        <h3>Conditions</h3>
        <dl class="row">
            <dt class="col-3 order-1">Ambient</dt>
            <dd class="col-3 order-1" title="{{ Format.temp(session.sessionState.ambientTemp, fahrenheit, true) }}">{{ Format.temp(session.sessionState.ambientTemp, fahrenheit) }}</dd>
            <dt class="col-3 order-2">Track</dt>
            <dd class="col-3 order-2" title="{{ Format.temp(session.sessionState.trackTemp, fahrenheit, true) }}">{{ Format.temp(session.sessionState.trackTemp, fahrenheit) }}</dd>
            <dt class="col-3 order-3">Raining</dt>
            <dd class="col-3 order-3">{{ Format.percent(session.sessionState.raining) }}</dd>
            <dt class="col-lg-4 col-3 order-1">Wetness (min)</dt>
            <dd class="col-lg-2 col-3 order-1">{{ Format.percent(session.sessionState.minPathWetness) }}</dd>
            <dt class="col-lg-4 col-3 order-2">Wetness (avg)</dt>
            <dd class="col-lg-2 col-3 order-2">{{ Format.percent(session.sessionState.averagePathWetness) }}</dd>
            <dt class="col-lg-4 col-3 order-3">Wetness (max)</dt>
            <dd class="col-lg-2 col-3 order-3">{{ Format.percent(session.sessionState.maxPathWetness) }}</dd>
        </dl>
    </div>
</div>
}

@if(hasStandings) {
<app-session-standings [session]="session" />
} @else {
<app-session-results [session]="session" />
}

}
